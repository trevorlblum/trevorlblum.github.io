<!DOCTYPE html>
<!-- 
  22/11/2024 added a reference canvas. This needs to have the reference strip assembly in a canvas to get the reference colour for stip compare
  15/9/2024 looking at moveable rectangle marker for matched colour. "overlay" shows as empty
  14/9/2024 added black rect to use as eventual comparison outliner
  14/9/2024 extended image map click areas, added map rect coords and mouse X and Y to click alert
  14/9/2024 image one_strip.png mapped for click as "img" 
  25/8/2024 added max strip to screen. changed size on ref images.
  next trick is compare colours of test and ref.
  24/8/2024 added show of strip legends. Would have liked <pre> to work, but.
  Added part map for one_strip click as start of compare protein reference colours
  26/7/2024 Livingstone strips and reference chart display -->
<html><title> 23/11/strips/ </title>
<head>
<style>
div.fixed {
   position:fixed;
   left:100px;
   top:50px;
}
div.legend{
   position:fixed;
   right:200px;
   top:50px;
}
div.strip_max{
   position:fixed;
   left:770px;
   top:75px;
}
div.variable{ 
    position:fixed;
    top:80px; 
    right:200px; 
    width 50px; 
    height:50px; 
    border:3px solid #77ff77;
}
div.reference{
    position:fixed;
    top:80px; 
    right:200px; 
    width 850px; 
    height:850px; 
    border:3px solid #77ff77;
}

</style>
</head>

<body>
<strong>strips/ 23/11/2024<br><br><br><strong>

<div class="variable">
<canvas id="canvas" width="800px" height="900px" draggable="true" ondrop="dropit(event)" ondragover="allowDrop(event)" ></canvas>
</div>

<div id="vertical" >
<img id="one_strip" src="strips/one_strip.png" usemap="#strip">
</div>

<div class="variable">
  <img id="overlay" src="strips/rect.png" align="right" >
</div>

<div class="strip_max" id="strip_max">
  <strip src="strips/one_strip_max.png" usemap="#strip_max">
</div>

<div class="legend" id="legend" ></div>

<div class="fixed" id="ref" ;>
<canvas id="reference" width="800px" height="900px" draggable="true" ondrop="dropit(event)" ondragover="allowDrop(event)" >
<img src="strips/leucocytes.png"><br>
<img src="strips/nitrite.png"><br>
<img src="strips/urobiliogen.png"><br>
<img src="strips/protein.png"><br>
<img src="strips/pH.png"><br>
<img src="strips/blood.png"><br>
<img src="strips/specific_gravity.png"><br>
<img src="strips/ketone.png"><br>
<img src="strips/bilirubin.png"><br>
<img src="strips/glucose.png"><br>
<br>
</canvas>
</div>

<div id="text"><p Text from click ></div>

<map name="strip">
  <area shape="rect" coords="0,10,55,65" onclick="strip_name('Leucocytes',coords,event)">
  <area shape="rect" coords="0,85,55,155" onclick="strip_name('Nitrite',coords,event)">
  <area shape="rect" coords="0,175,55,245" onclick="strip_name('Urobilinogen',coords,event)">
  <area shape="rect" coords="0,265,55,330" onclick="strip_name('Protein',coords,event)">
  <area shape="rect" coords="0,345,55,400" onclick="strip_name('pH',coords,event)">
  <area shape="rect" coords="0,435,55,490" onclick="strip_name('Blood',coords,event)">
  <area shape="rect" coords="0,525,55,580" onclick="strip_name('SG',coords,event)">
  <area shape="rect" coords="0,610,55,665" onclick="strip_name('Ketone',coords,event)">
  <area shape="rect" coords="0,695,55,755" onclick="strip_name('Bilirubin',coords,event)">
  <area shape="rect" coords="0,785,55,845" onclick="strip_name('Glucose',coords,event)">
</map>

<script>
legend_array=new Array(10,8);
//strip legends array is 8 wide by 10 deep
legend=["Leucocytes: 0neg:::15trace:70+:125++:500+++:",
"Nitrite:neg::::Positive:Positive:",
"Urobilinogen:0.2normal:16Normal:::33umol/L:66umol/L:131umol/L:",
"Protein:neg:trace::0.3g/L:1++:3+++:>20++++:",
"pH:5.0:6.0:6.5:7.0:7.5:8.0:8.5:",
"Blood:neg:Trace10:Moderate80:trace:small25:moderate60:large200:",
"Specific Gravity:1.000:1.005:1.010:1.015:1.020:1.025:1.030:",
"Ketone:neg::0.5mmol/L:1.5mmol/L:4mmol/L:8mmol/L:16mmol/L:",
"Bilirubin:neg::::small+:moderate++:large+++:",
"Glucose:neg::trace5.5mmol/L:14mmol/L:28++mmol/L:55+++mmol/L:>=111++++mmol/L:"];

document.getElementById("text").innerHTML="UnClicked";
//alert("overlay "+document.getElementById("overlay").innerHTML);


legends();

const refer=document.getElementById("reference");
const ctxref=refer.getContext("2d");
imageref=new Image();
imageref.src="strips/leucocytes.png";
ctxref.drawImage(imageref,0,0);
ctxref.drawImage(imageref,0,80);
ctxref.drawImage(imageref,0,160);
ctxref.drawImage(imageref,0,240);
//ctxref.fillStyle="red";
ctxref.fillStyle='rgba(255,255,0,.5)';
//ctxref.fillRect(0,0,700,860);

const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
//ctx.fillStyle="red";
//ctx.fillRect(0,0,800,185);
imageref=new Image();
imageref.src="strips/nitrite.png";
ctx.drawImage(imageref,0,0);
ctx.drawImage(imageref,0,80);
ctx.getImageData(0,0,40,40);

markup();

function allowDrop(ev) {
  ev.preventDefault();
}
function drag(ev){
  alert("drag invoked");
}

function drag(){
if(document.getElementById("text").innerHTML=="Clicked")document.getElementById("text").innerHTML="Clicked off";
else 
 document.getElementById("text").innerHTML="Clicked";

 imgrect=new Image();
 img.src="strips/rect.png";
 ctx.drawImage(img,200,200);
 alert("In drag ");
}

function dropit(ev){
  dropX=ev.clientX-180;
  dropY=ev.clientY-30;
  ev.preventDefault();
  ctx.drawImage(img, 0, 0);
  ctx.fillStyle=dropcolour;
  ctx.fillRect(dropX,dropY,40,40);
  ctx.fillStyle='rgb(0,0,0)';
  ctx.fillRect(dropX+10,dropY+15,15,10);
alert("In dropit");
};
function legends(){
  document.getElementById("legend").innerHTML="<br><h4>LEGENDS";
for(x=0;x<10;x++){
  xbits=legend[x].split(":");
  document.getElementById("legend").innerHTML+="<br>";
  for(y=0;y<7;y++){ 
    legend_array[x,y]=xbits[y];
    if(xbits[y].length!=0)document.getElementById("legend").innerHTML+=xbits[y]+" : ";
    else
    document.getElementById("legend").innerHTML+="Blank : ";
  }
  document.getElementById("legend").innerHTML+="</h4>";
 }
}

function strip_name(name,coordinates,event){
  alert("you clicked "+name+ "at coords "+coordinates+ "mouse at "+event.clientX+":"+event.clientY);
  document.getElementById("text").innerHTML="Clicked";

}

function markup(){ //show markup/capture rectangles on strip image composite 
//needs to have the ctx of the reference area
scale=1.015;
rows=[0,85,175,265,345,435,525,610,695,785];
ctxref.fillStyle='rgba(0,0,255,.75)';
for(r=0;r<10;r++){
  for(c=0;c<8;c++){
    ctxref.fillRect(40+c*70,rows[r]*scale,40,40);
    data=ctx.getImageData(40+c*70,rows[r]*scale,40,40);
    ctxref.putImageData(data,65+c*70,20+rows[r]*scale);
  }
}

}
</script>

</body>
</html>