<!DOCTYPE HTML> 
<html>
<!--- 
2/11/2024 using external bookboxes.css. Looking at grid fade for no box in all-boxes.
1/11/2024  Got gridclick text <ol> working via intermediate text construct.
31/10/2024 in trouble with enlarge w/h ratio to get true image-item ratio
29/10/2024 fix box0 image - currently not present
-->
<head>
<title>Bookboxes Catalogue Search</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"

</head>

<body>
<link rel="stylesheet" href="bookboxes.css">
<H2>Showing book boxes catalogue to date(2/11/2024)<H2>
<p id="textpara" onclick="showtext()" > Click here to identify source</p>

<div id="list" class="textonly" > </div>

<div class="grid" >
 <div class="grid-container" id="grid-container" >
</div>
<div class="qinput">
<label for="qn">queryitems ( space separated ) Click enlarges image</label>
<input id="qname" type="text" name="qn" value="Samuel Beckett" style="font-size: 30px"><br>
</div>
<div class="qclick" id="query" onclick="querytext()" >Click here for query </div>
<div class="include"  ><img id="include" src="box0.jpg" width=400px height=400px onclick="enlarge(400)"></div>
<div class="options">
.......Set your query options here........<br>
 <input id="respect" type="radio" name="respect" value="respect" checked>
 <label for="query">Respect Case</label>
 <input id="ignore" type="radio" name="respect" value="ignore" >
 <label for="query">Ignore case<br></label>
 <input id="and" type="radio" name="anditems" value="and">
 <label for="query">AND items</label>
 <input id="or" type="radio" name="anditems" value="or" checked>
 <label for="query">OR items</label>
 <input id="not" type="radio" name="anditems" value="not" >
 <label for="query">NOT items<br></label>
</div>

<p id="thequery" ><br></p>
<div class="query_result"> <p id="query_result"> query result goes here</p></div>
<script id="all_boxes" type="text/javascript" src="all_boxes.txt"></script>

<body>


</body>

<script>
gridcount=5*5;
boxlist=8;
Build_grid(100,100,5,5);
//clear_grid(100,100,5,5);
function Build_grid(cellwidth,cellheight,xcellcount,ycellcount){
//function to dynamically build grid to accomodate new boxes
  for(b=1;b<ycellcount*xcellcount+1;b++){
   if(b<=boxlist)document.getElementById("grid-container").innerHTML+="<div class=\"grid-item\"  id=\"grid-item"+b+"\" onclick=\"itemclick("+b+")\">box"+b+" </div>";
else
  document.getElementById("grid-container").innerHTML+="<div class=\"grid-item\"  id=\"grid-item"+b+"\" onclick=\"itemclick("+9+")\">n/a</div>";
  }
}
function clear_grid(cellwidth,cellheight,xcellcount,ycellcount){
//function to dynamically build grid to accomodate new boxes
  document.getElementById("grid-container").innerHTML="";
  for(b=1;b<ycellcount*xcellcount+1;b++){
   document.getElementById("grid-container").innerHTML+="<div class=\"grid-item\"  id=\"grid-item"+b+"\" onclick=\"itemclick("+b+")\">box"+b+" </div>";
  }
}

function showtext(){
  document.getElementById("textpara").innerHTML="all_boxes begins with <br>"+all_boxes.substring(0,5)+"<br>"+all_boxes.substring(6,21)+"<br>"+all_boxes.substring(22,66);
document.getElementById("textpara").innerHTML+="<br>single_box(box2.txt) begins with <br>"+multilinestring.substring(0,5)+"<br>"+multilinestring.substring(6,21)+"<br>"+multilinestring.substring(22,66);

  }

function itemclick(item){
thisbox=0;
thistext="";
  showtxt=true;
//  document.getElementById("textpara").innerHTML="Click enlarges image";
  document.getElementById("include").width=400;
  document.getElementById("include").height=400;
  document.getElementById("include").src="box"+item+".jpg";
  if(showtxt){
    thistext+="<ol type=\"1\">";
    q=all_boxes.split('\n');
    for(b=0;b<q.length;b++){
      if(q[b].substring(0,3)=="BOX"){
        thisbox=q[b].substring(3,4);
      }
        if(thisbox==item){
         thistext+="<li>"+q[b]+"</li>";
       }
   }
  }
  thistext+="</ol>";
  document.getElementById("list").innerHTML=thistext;
}

function querytext(){
clear_grid(100,100,5,5);
 boxnum=0;
 found=false;
 foundinbox=false;
 respectcase=false; if(document.getElementsByName("respect")[0].checked)respectcase=true;
 ignorecase=false; if(document.getElementsByName("respect")[1].checked)ignorecase=true;
 anditems=false;
//alert("Respect Case "+respectcase+" Ignore Case "+ignorecase);
  anditems=false; if(document.getElementsByName("anditems")[0].checked)anditems=true;
  oritems=false;  if(document.getElementsByName("anditems")[1].checked)oritems=true;
  notitems=false; if(document.getElementsByName("anditems")[2].checked)notitems=true;

 thisquery=document.getElementById("qname").value;
 queryitems=thisquery.split(" ");
 document.getElementById("query_result").innerHTML="";
//OR items
 all_boxes_parse=all_boxes.split('\n');
boxlist=0;//count of available boxes for fade of unavailable items

//respect case
if(respectcase){
for(b=0;b<all_boxes_parse.length;b++){
 if(all_boxes_parse[b].substring(0,3)=="BOX")boxnum+=1;
// alert("testing boxnum "+boxnum);
 for(s=0;s<queryitems.length;s++){
   if(all_boxes_parse[b].indexOf(queryitems[s])!=-1){
    document.getElementById("query_result").innerHTML+="<br> BOX "+boxnum+" line "+b+":" +all_boxes_parse[b];
    found=true;
    if(all_boxes_parse[b].substring(0,3).toUpperCase()!="BOX")gridimage(boxnum);
    if(!foundinbox&&found&&all_boxes_parse[b].substring(0,3)!="BOX"){
//    alert("found respect BOX= "+boxnum);
       foundinbox=true;
       found=false;
      }
   }
  }
 }
}

//ignore case
 if(!respectcase){
  for(b=0;b<all_boxes_parse.length;b++){
  if(all_boxes_parse[b].substring(0,3)=="BOX")boxnum+=1;
   for(s=0;s<queryitems.length;s++){
    if(all_boxes_parse[b].toUpperCase().indexOf(queryitems[s].toUpperCase())!=-1){
    document.getElementById("query_result").innerHTML+="<br> BOX "+boxnum+" line "+b+":" +all_boxes_parse[b];   
    found=true;
    if(all_boxes_parse[b].substring(0,3).toUpperCase()!="BOX")gridimage(boxnum);
    if(!foundinbox&&found&&all_boxes_parse[b].substring(0,3)!="BOX"){
       foundinbox=true;
       found=false;    
    }
   }
  }
 }
}

//document.getElementById("query_result").innerHTML+="<br>All_boxes_parse.length = "+all_boxes_parse.length;
//itemclick(0);
}

function gridimage(boxnum){
// replace each grid box text with box image if line found
//alert("grid-item1" +document.getElementById("grid-item"+boxnum).innerHTML);
document.getElementById("grid-item"+boxnum).innerHTML="<img src=\"box"+boxnum+".jpg\""+" height=\"50\">";
}

function enlarge(size){
//w and h need to be the grid-item image sizes, not "include" sizes
w=document.getElementById("include").width;
h=document.getElementById("include").height;
ratio=w/h;
document.getElementById("include").width=w*2;
document.getElementById("include").height=h*2/ratio;
if(h>1000 || w>1000){
document.getElementById("include").width=size;
document.getElementById("include").height=size/ratio;
}
}


</script>


</html>
